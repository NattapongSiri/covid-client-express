(this["webpackJsonpcovid-client"]=this["webpackJsonpcovid-client"]||[]).push([[0],{59:function(e,t,a){e.exports=a.p+"static/media/watson-avatar.d9c2b1bd.png"},62:function(e,t,a){e.exports=a.p+"static/media/watsondark.942da270.gif"},63:function(e,t,a){e.exports=a.p+"static/media/watsonlight.7ef19e7f.gif"},75:function(e,t,a){e.exports=a(99)},90:function(e,t,a){},91:function(e,t,a){},99:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(24),i=a.n(o),c=a(65),s=a(44),l=(a(90),a(11)),u=(a(91),a(18)),d=a.n(u),m=a(66),p=a(27),g=a(35),h=a.n(g),f=a(126),b=a(130),v=a(69),E=a(133),y=a(58),x=a.n(y),w=a(135),k=a(136),O=a(120),j=a(121),S=a(122),C=a(36),_=a(123),I=a(124),T=a(125),P=a(119),R=a(59),N=a.n(R),A=navigator.language?navigator.language:"en_US",D=r.a.createContext({locale:A,light:!1,toggleLight:function(){},setLocale:function(e){}}),W=Object(b.a)((function(e){return{self:{maxWidth:"75vw",width:"max-content",height:"max-content",display:"inline-block",color:e.palette.text.primary,backgroundColor:e.palette.background.paper,borderRadius:"4px",boxShadow:"2px 8px 5px #000",position:"relative",margin:"0 12px 0 0",zIndex:10},other:{maxWidth:"75vw",width:"max-content",height:"max-content",display:"inline-block",color:e.palette.text.primary,backgroundColor:e.palette.background.paper,borderRadius:"4px",boxShadow:"2px 8px 5px #000",position:"relative",margin:"0 0 0 10px",zIndex:10}}})),L=Object(b.a)((function(e){return{self:{position:"absolute",width:0,height:0,right:"-2px",bottom:"40px",left:"auto",zIndex:-1,"&:after":{content:'""',position:"absolute",border:"0 solid transparent",borderTop:"9px solid ".concat(e.palette.background.paper),borderRadius:"0 20px 0",width:"15px",height:"30px",transform:"rotate(45deg) scaleY(-1)"}},other:{position:"absolute",width:0,bottom:"42px",left:"-16px",height:0,zIndex:-1,"&:after":{content:'""',position:"absolute",border:"0 solid transparent",borderTop:"9px solid ".concat(e.palette.background.paper),borderRadius:"0 20px 0",width:"15px",height:"30px",transform:"rotate(145deg)"}}}})),F=Object(b.a)({self:{fontWeight:600,fontSize:"0.7rem",color:"#66ff99",textAlign:"right"},other:{fontWeight:600,fontSize:"0.7rem",color:"#66ccff",textAlign:"left"}}),U=Object(b.a)((function(e){return{self:{backgroundColor:e.palette.background.default,display:"flex",flexWrap:"wrap",alignItems:"flex-end",justifyContent:"flex-end",margin:"1vw 0",position:"relative"},other:{backgroundColor:e.palette.background.default,display:"flex",flexWrap:"wrap",alignItems:"flex-end",justifyContent:"flex-start",margin:"1vw 0",position:"relative"}}})),K=Object(b.a)({root:{flexBasis:"100%"}});function B(e){var t=e.message,a=e.onChoose;return function(){var e="self"===t.type,o=Object(v.a)(),i=W(o),c=L(o),s=F(),l=U(o),u=K(),d=Object(b.a)({root:{padding:"1vh 2vw"}})(),m=Object(n.useContext)(D),p=new Intl.DateTimeFormat(m.locale,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"});return r.a.createElement(P.a,{theme:o},r.a.createElement("div",{className:e?l.self:l.other},!e&&r.a.createElement(w.a,{style:{display:"inline-block"},src:N.a}),r.a.createElement("div",{className:e?i.self:i.other},r.a.createElement(k.a,{elevation:0},r.a.createElement(O.a,{classes:{root:d.root,subheader:e?s.self:s.other},subheader:e?"You":"Watson",titleTypographyProps:{variant:"body2"}}),r.a.createElement(j.a,null),r.a.createElement(S.a,{style:{padding:"8px 55px 8px 14px",margin:0}},r.a.createElement(C.a,{style:{overflow:"auto"}},r.a.createElement("span",{style:{textAlign:"left"},dangerouslySetInnerHTML:{__html:t.message}}))),t.suggestions&&r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,null),r.a.createElement(S.a,null,t.suggestions.map((function(e){return r.a.createElement(_.a,{key:e.uuid,style:{margin:"2vmin"},variant:"outlined",onClick:function(){a&&a(e.label)}},e.label)})))),t.reference&&r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,null),r.a.createElement(I.a,null,r.a.createElement(_.a,{variant:"outlined",onClick:function(){window.open(t.reference)}},"Click to view original page"))),t.previewUrl&&r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,null),r.a.createElement(T.a,null,r.a.createElement("iframe",{title:t.message,style:{width:"75vw",height:"75vh"},src:t.previewUrl.toString()})))),r.a.createElement("div",{className:e?c.self:c.other})),e&&r.a.createElement(w.a,{style:{display:"inline-block"}}),r.a.createElement("div",{className:u.root}),r.a.createElement(C.a,{color:"textSecondary",variant:"body2",display:"block",style:{margin:e?"3px 55px 1vh 0":"3px 0 1vh 55px"}},p.format(t.timestamp))))}()}function z(e){var t=e.messages,a=e.style,o=e.onChoose,i=Object(n.useRef)(null),c=function(){i&&i.current?i.current.scrollIntoView({block:"end",behavior:"smooth"}):console.error("Bottom anchor reference is missing")};return Object(n.useEffect)((function(){var e=x()(c,80);return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}})),Object(n.useEffect)((function(){return c()})),r.a.createElement(f.a,{style:a},t.map((function(e){if(e.results)return r.a.createElement(r.a.Fragment,{key:e.uuid.substring(1)},r.a.createElement(B,{key:e.uuid,message:e,onChoose:o}),e.results.map((function(e){return r.a.createElement(B,{key:e.uuid,message:{uuid:e.uuid,message:e.highlight,type:"Watson",timestamp:new Date,reference:e.url}})})));if(e.message.startsWith("<a ")){var t=e.message.toLowerCase().indexOf('href="')+6,a=e.message.indexOf('"',t+1);if(t<a){var n=new URL(e.message.substring(t,a));e.previewUrl=n}return r.a.createElement(B,{key:e.uuid,message:e,onChoose:o})}if(e.message.startsWith("http")){var i=new URL(e.message);return e.message=i.hostname,e.previewUrl=i,r.a.createElement(B,{key:e.uuid,message:e,onChoose:o})}return r.a.createElement(B,{key:e.uuid,message:e,onChoose:o})})),r.a.createElement("div",{style:{width:0,height:0,display:"block"},ref:i}))}var M,H,Y=a(61),$=a(137),V=a(128),G=a(129),J=a(127),X=Object(b.a)((function(e){return{root:{alignItem:"center",borderRadius:"50%",border:"1px solid grey",color:e.palette.text.primary,cursor:"pointer",margin:"0 2vw",padding:"1vw"}}})),q=Object(b.a)((function(e){return{root:{display:"inline-block",position:"relative",width:"10vw",height:"10vw","& div":{position:"absolute",top:"45%",width:"15%",height:"15%",borderRadius:"50%",background:e.palette.text.primary,animationTimingFunction:"cubic-bezier(0, 1, 1, 0)","&:nth-child(1)":{left:"10%",animation:"$ldsEllipsis1 0.6s infinite"},"&:nth-child(2)":{left:"10%",animation:"$ldsEllipsis2 0.6s infinite"},"&:nth-child(3)":{left:"40%",animation:"$ldsEllipsis2 0.6s infinite"},"&:nth-child(4)":{left:"70%",animation:"$ldsEllipsis3 0.6s infinite"}}},"@keyframes ldsEllipsis1":{"0%":{transform:"scale(0)"},"100%":{transform:"scale(1)"}},"@keyframes ldsEllipsis3":{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0)"}},"@keyframes ldsEllipsis2":{"0%":{transform:"translate(0, 0)"},"100%":{transform:"translate(3vw, 0)"}}}}));function Q(e){var t=e.onClick,a=Object(v.a)(),n=q(a);return r.a.createElement("div",{onClick:t,className:n.root},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null))}function Z(e){var t=e.onClick,a=e.onData,o=e.onStateChange;return function(){var e=Object(n.useState)(M.undefined),i=Object(l.a)(e,2),c=i[0],s=i[1],u=Object(n.useContext)(D);Object(n.useEffect)((function(){return navigator.mediaDevices.getUserMedia({audio:!0}).then((function(){if(console.log("Mic is available"),void 0===window.SpeechRecognition){var e=window.webkitSpeechRecognition;window.SpeechRecognition=e}var t=window.SpeechRecognition;t?(H=new t).interimResults=!0:console.log("SpeechRecognition is not supported"),s(M.ready)})).catch((function(e){console.error(e)})),function(){H&&H.abort()}}),[]),H&&(H.lang=u.locale);var d=Object(v.a)(),m=X(d),p=function(e){var n=c;switch(c){case M.undefined:console.log("SpeechRecognition is not available"),o&&o(M.ready,n);break;case M.ready:console.log("Start recognition"),H.start(),H.onspeechend=function(){console.log("End of speech detected"),s(M.ready),o&&o(M.ready,M.start)},a&&(H.onresult=function(e){a(e.results[0][0].transcript)}),s(M.start),o&&o(M.start,n);break;case M.start:console.log("Aborting recognition"),H.abort();break;default:console.error("Unknown SpeechRecognition state")}t&&t(e,n)};return r.a.createElement(r.a.Fragment,null,c===M.ready&&r.a.createElement(J.a,{onClick:p,className:m.root,fontSize:"large"}),c===M.start&&r.a.createElement(Q,{onClick:p}))}()}!function(e){e[e[void 0]=0]="undefined",e[e.start=1]="start",e[e.ready=2]="ready"}(M||(M={}));var ee,te=Object(b.a)({root:{alignContent:"stretch",alignItems:"center",display:"flex",width:"100vw",height:"20vh"}}),ae=Object(b.a)({root:{flexGrow:1}});function ne(e){var t=e.style,a=e.locked,o=void 0!==a&&a,i=e.onSubmit,c=Object(Y.a)(),u=Object(s.b)("chatDialog").t,d=te(),m=ae(),p=Object(n.useState)(""),g=Object(l.a)(p,2),h=g[0],b=g[1],v=Object(n.useState)(!1),E=Object(l.a)(v,2),y=E[0],x=E[1],w=Object(n.useState)(ee.Keyboard),k=Object(l.a)(w,2),O=k[0],j=k[1],S=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,a=Object(n.useState)(e),r=Object(l.a)(a,2),o=r[0],i=r[1];return Object(n.useEffect)((function(){var a=setTimeout((function(){return i(e)}),t);return function(){return clearTimeout(a)}}),[e,t]),o}(h,100);return Object(n.useEffect)((function(){y&&S.trim().length>0&&i&&(i(S),x(!1),b(""))}),[S,y,i]),r.a.createElement(P.a,{theme:c},r.a.createElement(f.a,{className:d.root,style:t},r.a.createElement($.a,{className:m.root,disabled:o,placeholder:u("inputHelper"),onChange:function(e){return b(e.target.value)},onKeyDown:function(e){"Enter"!==e.key&&13!==e.keyCode||x(!0)},value:h,endAdornment:O===ee.Keyboard&&h.trim().length>0&&r.a.createElement(V.a,{position:"end",style:{cursor:"pointer"},onClick:function(){x(!0)}},r.a.createElement(G.a,null))}),r.a.createElement(Z,{onData:function(e){return b(e)},onStateChange:function(e,t){e===M.start?j(ee.Voice):e===M.ready&&t===M.start&&(j(ee.Keyboard),console.log("Auto submit user input"),x(!0))}})))}!function(e){e[e.Keyboard=0]="Keyboard",e[e.Voice=1]="Voice"}(ee||(ee={}));var re=a(67),oe=a(132),ie=a(100),ce=a(46),se=a.n(ce),le=a(62),ue=a.n(le),de=a(63),me=a.n(de),pe=Object(b.a)((function(e){return{root:{display:"block",height:"12vh","& > img":{height:"inherit",width:"auto",display:"inline",position:"absolute",top:"0",left:"50%",transform:"translateX(-50%)"}}}})),ge=a(68),he=a(138),fe=a(139),be=a(131),ve={Thai:"th-TH",US:"en-US"};function Ee(e){var t=e.style,a=Object(Y.a)(),o=Object(n.useContext)(D);return r.a.createElement(P.a,{theme:a},r.a.createElement(he.a,{style:Object(ge.a)({},t,{width:"10vw"})},r.a.createElement(fe.a,{id:"langid",style:{color:a.palette.text.primary}},"Language"),r.a.createElement(be.a,{inputProps:{name:"langid",id:"langid"},value:o.locale,onChange:function(e){o.setLocale(e.target.value)}},Object.keys(ve).map((function(e){return r.a.createElement("option",{key:e,value:ve[e]},e)})))))}var ye=Object(b.a)({root:{borderRadius:"10vmin",backgroundColor:"#444",color:"#CCC",position:"absolute",top:"4vh",right:"15vw"}}),xe=Object(ie.a)({root:{},switchBase:{"&$checked+ $track":{backgroundColor:"#888",opacity:1}},track:{backgroundColor:"#888",opacity:1},checked:{}})((function(e){var t=e.classes,a=Object(re.a)(e,["classes"]);return r.a.createElement(oe.a,Object.assign({},a,{classes:{track:t.track,switchBase:t.switchBase,checked:t.checked}}))}));function we(){var e=Object(v.a)(),t=pe(e),a=ye(),o=Object(n.useContext)(D);return r.a.createElement(f.a,{className:t.root},"dark"===e.palette.type&&r.a.createElement("img",{src:ue.a,alt:"IBM Watson"}),"dark"!==e.palette.type&&r.a.createElement("img",{src:me.a,alt:"IBM Watson"}),r.a.createElement(xe,{className:a.root,checked:o.light,onChange:function(){o.toggleLight&&o.toggleLight()},checkedIcon:r.a.createElement(se.a,{style:{color:"#FFF"}}),icon:r.a.createElement(se.a,{style:{color:"#000"}})}),r.a.createElement(Ee,{style:{position:"absolute",top:"3vh",right:"2vw"}}))}xe.displayName="LightSwitch";var ke=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_APIKEY:"65c191a6-e57c-4b65-a531-e2edff3f79b9",REACT_APP_CREATE_SESSION_ENDPOINT:"https://e5a82385.us-south.apigw.appdomain.cloud/ibmth_covid/create_wa_session",REACT_APP_SEND_MSG_ENDPOINT:"https://e5a82385.us-south.apigw.appdomain.cloud/ibmth_covid/message_wlt_wa",REACT_APP_RETRY_SEND:"1"}),Oe=ke.REACT_APP_APIKEY,je=ke.REACT_APP_CREATE_SESSION_ENDPOINT,Se=ke.REACT_APP_SEND_MSG_ENDPOINT;function Ce(){return _e.apply(this,arguments)}function _e(){return(_e=Object(p.a)(d.a.mark((function e(){var t,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!je||!Oe){e.next=10;break}return e.next=3,fetch(je,{method:"POST",cache:"no-cache",headers:{"X-IBM-Client-Id":Oe}});case 3:return t=e.sent,e.next=6,t.json();case 6:return a=e.sent,e.abrupt("return",a);case 10:console.error("Undefined messaging endpoint or APIKEY is invalid");case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ie(e){return Te.apply(this,arguments)}function Te(){return(Te=Object(p.a)(d.a.mark((function e(t){var a,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.targetLang="en",!Se||!Oe){e.next=11;break}return e.next=4,fetch(Se,{method:"POST",cache:"no-cache",headers:{"Content-Type":"application/json","X-IBM-Client-Id":Oe},body:JSON.stringify(t)});case 4:return a=e.sent,e.next=7,a.json();case 7:return n=e.sent,e.abrupt("return",n);case 11:console.error("Undefined messaging endpoint or APIKEY is invalid");case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Pe=parseInt("1"),Re=Object(b.a)((function(e){return{root:{backgroundColor:e.palette.background.default}}}));function Ne(){var e=Object(v.a)(),t=Re(e),a=Object(n.useState)(),o=Object(l.a)(a,2),i=o[0],c=o[1],s=Object(n.useState)([]),u=Object(l.a)(s,2),g=u[0],b=u[1],y=Object(n.useContext)(D),x=function(){var e=Object(p.a)(d.a.mark((function e(t){var a,n,r,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g=g.concat({uuid:"m".concat(Object(E.a)()),message:t,type:"self",timestamp:new Date}),b(g),i){e.next=7;break}return e.next=5,Ce();case 5:201===(a=e.sent).status&&(c(a.result.session_id),i=a.result.session_id);case 7:n=0;case 8:if(!(n<=Pe)){e.next=26;break}if(!i){e.next=23;break}return e.next=12,Ie({sessionId:i,message:t,sourceLang:y.locale.substring(0,2)});case 12:if(200!==(r=e.sent).status){e.next=19;break}if("break"!==function(){var e,t=r.result.output,a=r.result.context,n=t.generic;console.debug(r);var o=n.map((function(e){switch(e.response_type){case"text":return{uuid:"m".concat(Object(E.a)()),message:h()(e.text),type:"Watson",timestamp:new Date,context:a};case"suggestion":return{uuid:"m".concat(Object(E.a)()),message:e.title,type:"Watson",timestamp:new Date,context:a,suggestions:e.suggestions.map((function(e){return{uuid:"su".concat(Object(E.a)()),label:e.label,intents:e.value.input.intents}}))};case"search":return{uuid:"m".concat(Object(E.a)()),message:e.header,type:"Watson",timestamp:new Date,context:a,results:e.results.map((function(e){var t=void 0;return e.result_metadata&&e.result_metadata.source&&e.result_metadata.source.link?t=e.result_metadata.source.link.url:e.url&&(t=e.url),{uuid:"se".concat(Object(E.a)()),title:h()(e.title),highlight:h()(e.highlight.body[0]),url:t?h()(t):void 0}}))};case"option":return{uuid:"m".concat(Object(E.a)()),message:e.title,type:"Watson",timestamp:new Date,context:a,suggestions:e.options.map((function(e){return{uuid:"op".concat(Object(E.a)()),label:e.label}}))};default:return{uuid:"m".concat(Object(E.a)()),message:"Unsupported type of response. Please contact admin.",type:"Watson",timestamp:new Date}}}));return g=(e=g).concat.apply(e,Object(m.a)(o)),b(g),"break"}()){e.next=17;break}return e.abrupt("break",26);case 17:e.next=23;break;case 19:return e.next=21,Ce();case 21:201===(o=e.sent).status&&(c(o.result.session_id),i=o.result.session_id);case 23:n++,e.next=8;break;case 26:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(f.a,{className:t.root},r.a.createElement(we,null),r.a.createElement(z,{style:{height:"70vh",overflow:"scroll",padding:"0 0 0 0",margin:"0 0 0 0"},messages:g,onChoose:x}),r.a.createElement(ne,{style:{height:"18vh"},onSubmit:function(e){x(e)}}))}var Ae=a(64),De=Object(Ae.a)({palette:{background:{default:"#000"},text:{primary:"#FFF",secondary:"#FFF"},type:"dark"}}),We=Object(Ae.a)({palette:{background:{paper:"#FFE"},type:"light"}});var Le=function(){var e=localStorage.getItem("locale"),t=Object(n.useState)(e||A),a=Object(l.a)(t,2),o=a[0],i=a[1],c=Object(n.useState)("true"===localStorage.getItem("light")),s=Object(l.a)(c,2),u=s[0],d=s[1];return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement(D.Provider,{value:{locale:o,light:u,toggleLight:function(){localStorage.setItem("light",(!u).toString()),d(!u)},setLocale:function(e){localStorage.setItem("locale",e),i(e)}}},r.a.createElement(P.a,{theme:u?We:De},r.a.createElement(Ne,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Fe=navigator.language?navigator.language:"en_US";c.a.use(s.a).init({resources:{en:{chatDialog:{inputHelper:"Type your message here"}},th:{chatDialog:{inputHelper:"\u0e1e\u0e34\u0e21\u0e1e\u0e4c\u0e02\u0e49\u0e2d\u0e04\u0e27\u0e32\u0e21\u0e02\u0e2d\u0e07\u0e04\u0e38\u0e13\u0e17\u0e35\u0e48\u0e19\u0e35\u0e48"}}},lng:Fe}),i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Le,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[75,1,2]]]);
//# sourceMappingURL=main.bf1cb354.chunk.js.map